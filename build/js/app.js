"use strict";function getAreas(){return $.getJSON("https://api.myjson.com/bins/90h9l").done(function(e){var t=e;$.each(t,function(e,t){myAreas.push({id:t.id,name:t.name,loc:t.loc,info:t.info,coords:t.coords,fill:t.fill,img:t.img})}),ko.applyBindings(new AppViewModel),initMap()}).fail(function(e){}),!1}function AppViewModel(){var e=this;this.searchTerm=ko.observable(""),this.poiList=ko.observableArray([]),myAreas.forEach(function(t){e.poiList.push(new Poi(t))}),this.currentPoi=ko.observable(this.poiList()[0]),this.setPoi=function(t){for(var r=0;r<myAreas.length;r++)e.poiList()[r].select("0");e.currentPoi(t),e.currentPoi().select("1");var a=document.getElementsByClassName("liArea");for(r=0;r<a.length;r++){var o=a[r];$(o).removeClass("selected"),1===a[r].value&&$(o).addClass("selected")}}}function initMap(){var e=myAreas,t=14,r=Math.max(document.documentElement.clientWidth,window.innerWidth||0);r<=1e3&&(t=13);var a=[{featureType:"administrative.country",elementType:"geometry.fill",stylers:[{color:"#98b9c5"}]},{featureType:"administrative.province",elementType:"geometry.fill",stylers:[{color:"#98b9c5"}]},{featureType:"administrative.locality",elementType:"geometry.fill",stylers:[{color:"#98b9c5"}]},{featureType:"administrative.neighborhood",elementType:"geometry.fill",stylers:[{color:"#98b9c5"}]},{featureType:"administrative.land_parcel",elementType:"geometry.fill",stylers:[{color:"#98b9c5"}]},{featureType:"landscape.man_made",elementType:"geometry.fill",stylers:[{color:"#9dbecb"}]},{featureType:"landscape.natural.landcover",elementType:"geometry.fill",stylers:[{color:"#96becd"}]},{featureType:"landscape.natural.terrain",elementType:"geometry.fill",stylers:[{color:"#ffffff"}]},{featureType:"poi.attraction",elementType:"geometry.fill",stylers:[{color:"#fff7dc"}]},{featureType:"poi.business",elementType:"geometry.fill",stylers:[{color:"#fff7dc"}]},{featureType:"poi.business",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"poi.government",elementType:"geometry.fill",stylers:[{color:"#fff7dc"}]},{featureType:"poi.medical",elementType:"geometry.fill",stylers:[{color:"#fff7dc"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#fff7dc"}]},{featureType:"poi.place_of_worship",elementType:"geometry.fill",stylers:[{color:"#ffc540"}]},{featureType:"poi.school",elementType:"geometry.fill",stylers:[{color:"#2d7488"}]},{featureType:"poi.sports_complex",elementType:"geometry.fill",stylers:[{color:"#9fdbea"}]},{featureType:"road.arterial",elementType:"geometry.fill",stylers:[{color:"#7da4b3"},{saturation:"0"}]},{featureType:"road.arterial",elementType:"geometry.stroke",stylers:[{color:"#b5cfd9"}]},{featureType:"road.arterial",elementType:"labels.text.fill",stylers:[{color:"#ffffff"}]},{featureType:"road.arterial",elementType:"labels.text.stroke",stylers:[{visibility:"simplified"}]},{featureType:"road.local",elementType:"geometry.fill",stylers:[{color:"#fbffcb"}]},{featureType:"transit.line",elementType:"geometry.fill",stylers:[{color:"#c9dbff"}]},{featureType:"transit.station.airport",elementType:"geometry.fill",stylers:[{color:"#beddff"}]},{featureType:"transit.station.bus",elementType:"geometry.fill",stylers:[{color:"#c0dff4"}]},{featureType:"transit.station.rail",elementType:"geometry.fill",stylers:[{color:"#00708b"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{color:"#79b7cd"}]}];map=new google.maps.Map(document.getElementById("map"),{center:centerOn,styles:a,zoom:t,mapTypeControl:!1});for(var o=0;o<e.length;o++){var l="img/pin.png";myMarker=new google.maps.Marker({position:e[o].loc,map:map,icon:l}),myMarkers.push(myMarker)}var n,s,i=[],c=new google.maps.InfoWindow({maxWidth:200}),p=document.getElementsByClassName("name");for(o=0;o<e.length;o++)n=new google.maps.Polygon({paths:e[o].coords,strokeColor:"black",strokeOpacity:.8,strokeWeight:.5,fillColor:e[o].fill,fillOpacity:.4,position:e[o].loc}),i.push(n),s=p[o],google.maps.event.addDomListener(s,"click",function(t,r){var a='<div><h3 class = "infoWindowHeading">'+e[t].name+"</h3><p>"+e[t].info+'<img src = "'+e[t].img+'"></p></div>';return function(){document.getElementsByClassName("name")[t].style.color="maroon";for(var o=0;o<p.length;o++)o!==t&&(p[o].style.color="black");c.setContent(a),c.open(map,r),map.panTo(e[t].loc)}}(o,n)),google.maps.event.addListener(n,"click",function(t,r){return function(){p[r].style.color="maroon",$(".name").removeClass("selected"),$(".name").addClass(function(e){if(r===e)return"selected"});for(var a=0;a<p.length;a++)a!==r&&(p[a].style.color="black");var o='<div><h3 class = "infoWindowHeading">'+e[r].name+"</h3><p><br>"+e[r].info+'<img src = "'+e[r].img+'"></p></div><div id="pano"></div>';c.setContent(o),c.open(map,t),map.panTo(e[r].loc);var l=function(){var t=e[r].loc,a=new google.maps.StreetViewPanorama(document.getElementById("pano"),{position:t,pov:{heading:34,pitch:10}});return map.setStreetView(a)};l()}}(n,o)),n.setMap(map);var f=[],m=[],y=[],d=[];$.each(fsqrData,function(e,t){posMarkerFsqr.lat=t.lat,posMarkerFsqr.lng=t.lng,f.push(t.name),m.push(t.address),y.push(t.phone),d.push(t.url),iconMarkerFsqr=t.iconPre+"bg_32"+t.iconSuf,markerFsqr=new google.maps.Marker({position:posMarkerFsqr,map:map,icon:iconMarkerFsqr}),markerFsqr.addListener("click",function(){var t='<div><h3 class = "infoWindowHeading">'+f[e]+"</h3><p> "+m[e][0]+"  <br> "+m[e][1]+"<br>"+m[e][2]+"<br>"+y[e]+'   <br><a title="This link will open in a new tab" href = " '+d[e]+'" target="_blank" >'+d[e]+"</a></p></div>";c.setContent(t),c.open(map,this)}),markersFsqr.push(markerFsqr)})}$(function(){$("#info").click(function(){$(".headerSubText").is(":visible")?$(".headerSubText").hide():$(".headerSubText").show()})});var myAreas=[],fsqrData=[];getAreas();var Poi=function(e){this.name=ko.observable(e.name),this.id=ko.observable(e.id),this.select=ko.observable("0")};this.submit=function(){getFoursquareData(myAreas)};var choose=function(){for(var e=document.getElementsByClassName("liArea"),t=0;t<e.length;t++)if(e[t].classList.contains("selected"))return t},getFoursquareData=function(e){var t=choose(),r=$("#fsqr-articles");r.text("");var a=(e[t].loc,$("#inputSearch").val()),o=e[t].name,l=e[t].loc.lat+","+e[t].loc.lng,n=$("#fsqr-header");if(n.html('These are the results for  <span class="standOut">'+a+'</span>  in the  <span class="standOut">'+o+"</span>  area:"),fsqrData.length=0,r.empty(),""!==t&&void 0!==t&&""!==a){var s="https://api.foursquare.com/v2/venues/search?client_id=XV45PHON55RFFRM3GNN1BODO2NWH45LCGBKPVQWLOKGUI4XA&client_secret=YVKQJGWU1G2TH1BGQXHULAGHOYDL443Z3HPQ0JBFCJWM4QPD&v=20130815&ll="+l+"&query="+a+"&intent=checkin&limit=15&radius=1000";return $.getJSON(s,function(e){var t=e.response.venues;$.each(t,function(e,t){t.categories[0]?fsqrData.push({name:t.name,lat:t.location.lat,lng:t.location.lng,address:t.location.formattedAddress,phone:t.contact.formattedPhone,url:t.url,iconPre:t.categories[0].icon.prefix,iconSuf:t.categories[0].icon.suffix}):t.categories[0]||fsqrData.push({name:t.name,lat:t.location.lat,lng:t.location.lng,address:t.location.formattedAddress,phone:t.contact.formattedPhone,url:t.url,iconPre:"https://ss3.4sqi.net/img/categories_v2/arts_entertainment/default_",iconSuf:".png"})}),$.each(fsqrData,function(e,t){void 0===t.url&&(t.url=" "),void 0===t.phone&&(t.phone=" ");for(var r=0;r<3;r++)void 0===t.address[r]&&(t.address[r]=" ")});var a=function(e){var t,a,o;0===e.length?r.append('<li class="article">No results found</li>'):$.each(e,function(e,l){t=l.name,a=l.url,o=" "===a?t:'<a href="'+a+'" title="'+a+' This link will open in a new tab" target="_blank">'+t+"</a>",r.append('<li class="article">'+o+"</li>")})};a(fsqrData),initMap(fsqrData)}).fail(function(e){n.text("Foursquare results could Not Be Loaded")}),!1}},centerOn={lat:52.539722,lng:13.431667},map,myMarker,myMarkers=[],markerFsqr,markersFsqr=[],iconMarkerFsqr,posMarkerFsqr={};